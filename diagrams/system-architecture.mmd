%% Finanzas SD System Architecture
%% Arquitectura del Sistema Finanzas SD
%% High-quality architecture diagram with improved visual clarity

graph TB
    %% User Interface Layer
    subgraph "üñ•Ô∏è User Interface Layer / Capa de Interfaz de Usuario"
        direction LR
        UI[React Frontend<br/>SPA Application<br/>---<br/>Frontend React<br/>Aplicaci√≥n SPA]
    end
    
    %% Content Delivery Layer
    subgraph "üåê CDN & Delivery Layer / Capa CDN y Entrega"
        direction TB
        CF[CloudFront Distribution<br/>Global CDN<br/>---<br/>Distribuci√≥n CloudFront<br/>CDN Global]
        S3[S3 Bucket<br/>Static Assets<br/>---<br/>Cubeta S3<br/>Activos Est√°ticos]
        CF --> S3
    end
    
    %% Authentication Layer
    subgraph "üîê Authentication Layer / Capa de Autenticaci√≥n"
        direction TB
        COG[AWS Cognito<br/>User Pool & Identity<br/>---<br/>Pool de Usuarios e Identidad]
        JWT[JWT Tokens<br/>Session Management<br/>---<br/>Tokens JWT<br/>Gesti√≥n de Sesi√≥n]
        COG --> JWT
    end
    
    %% API Layer
    subgraph "üö™ API Gateway Layer / Capa de API Gateway"
        direction TB
        APIGW[API Gateway<br/>REST API Endpoints<br/>---<br/>Gateway API<br/>Endpoints REST]
        AUTH[Authorizer Lambda<br/>Request Validation<br/>---<br/>Lambda Autorizador<br/>Validaci√≥n de Solicitud]
        APIGW --> AUTH
    end
    
    %% Authorization Layer
    subgraph "‚úÖ Authorization Layer / Capa de Autorizaci√≥n"
        direction TB
        AVP[Amazon Verified<br/>Permissions Engine<br/>---<br/>Motor de Permisos<br/>Verificados de Amazon]
        POLICY[Policy Store<br/>RBAC Rules<br/>---<br/>Almac√©n de Pol√≠ticas<br/>Reglas RBAC]
        AVP --> POLICY
    end
    
    %% Business Logic Layer
    subgraph "‚öôÔ∏è Business Logic Layer / Capa de L√≥gica de Negocio"
        direction LR
        PMO[PMO Service Lambda<br/>Project Portfolio Mgmt<br/>---<br/>Lambda Servicio PMO<br/>Gesti√≥n Cartera Proyectos]
        SDMT[SDMT Service Lambda<br/>SD Management Tools<br/>---<br/>Lambda Servicio SDMT<br/>Herramientas Gesti√≥n SD]
        VENDOR[Vendor Service Lambda<br/>Supplier Management<br/>---<br/>Lambda Servicio Proveedor<br/>Gesti√≥n de Proveedores]
    end
    
    %% Data Layer
    subgraph "üíæ Data Persistence Layer / Capa de Persistencia de Datos"
        direction LR
        DDB[(DynamoDB Tables<br/>NoSQL Database<br/>---<br/>Tablas DynamoDB<br/>Base de Datos NoSQL)]
        DDB_BACKUP[(Backup & Recovery<br/>Point-in-Time Recovery<br/>---<br/>Respaldo y Recuperaci√≥n<br/>Recuperaci√≥n Punto en Tiempo)]
        DDB --> DDB_BACKUP
    end
    
    %% Main Flow Connections
    UI -->|1. HTTPS Requests<br/>Solicitudes HTTPS| CF
    UI -->|2. Login/Signup<br/>Iniciar Sesi√≥n/Registrarse| COG
    COG -->|3. JWT Token<br/>Token JWT| UI
    UI -->|4. API Calls + JWT<br/>Llamadas API + JWT| APIGW
    
    %% API Gateway Flow
    AUTH -->|5. Validate Token<br/>Validar Token| COG
    AUTH -->|6. Check Permissions<br/>Verificar Permisos| AVP
    
    %% Service Routing
    AUTH -->|7. Route Request<br/>Enrutar Solicitud| PMO
    AUTH -->|7. Route Request<br/>Enrutar Solicitud| SDMT
    AUTH -->|7. Route Request<br/>Enrutar Solicitud| VENDOR
    
    %% Data Access
    PMO -->|8. Data Operations<br/>Operaciones de Datos| DDB
    SDMT -->|8. Data Operations<br/>Operaciones de Datos| DDB
    VENDOR -->|8. Data Operations<br/>Operaciones de Datos| DDB
    
    %% Response Flow
    PMO -->|9. Response<br/>Respuesta| APIGW
    SDMT -->|9. Response<br/>Respuesta| APIGW
    VENDOR -->|9. Response<br/>Respuesta| APIGW
    APIGW -->|10. JSON Response<br/>Respuesta JSON| UI
    
    %% Styling with better contrast and clarity
    classDef uiLayer fill:#bbdefb,stroke:#1976d2,stroke-width:3px,color:#000,font-weight:bold
    classDef cdnLayer fill:#fff9c4,stroke:#f57f17,stroke-width:3px,color:#000,font-weight:bold
    classDef authLayer fill:#ffccbc,stroke:#d84315,stroke-width:3px,color:#000,font-weight:bold
    classDef apiLayer fill:#c8e6c9,stroke:#388e3c,stroke-width:3px,color:#000,font-weight:bold
    classDef authzLayer fill:#f8bbd0,stroke:#c2185b,stroke-width:3px,color:#000,font-weight:bold
    classDef serviceLayer fill:#e1bee7,stroke:#7b1fa2,stroke-width:3px,color:#000,font-weight:bold
    classDef dataLayer fill:#b2dfdb,stroke:#00695c,stroke-width:3px,color:#000,font-weight:bold
    
    class UI uiLayer
    class CF,S3 cdnLayer
    class COG,JWT authLayer
    class APIGW,AUTH apiLayer
    class AVP,POLICY authzLayer
    class PMO,SDMT,VENDOR serviceLayer
    class DDB,DDB_BACKUP dataLayer

