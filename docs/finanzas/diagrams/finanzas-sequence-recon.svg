<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1206.25px" preserveAspectRatio="none" style="width:2025px;height:1206px;" version="1.1" viewBox="0 0 2025 1206" width="2025px" zoomAndPan="magnify"><defs/><g><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 5.0,5.0;" x1="64.0625" x2="64.0625" y1="128.5889" y2="1070.2393"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 5.0,5.0;" x1="375.7813" x2="375.7813" y1="128.5889" y2="1070.2393"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 5.0,5.0;" x1="1111.7188" x2="1111.7188" y1="128.5889" y2="1070.2393"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 5.0,5.0;" x1="1361.7188" x2="1361.7188" y1="128.5889" y2="1070.2393"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 5.0,5.0;" x1="1577.3438" x2="1577.3438" y1="128.5889" y2="1070.2393"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 5.0,5.0;" x1="1871.0938" x2="1871.0938" y1="128.5889" y2="1070.2393"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 5.0,5.0;" x1="1983.5938" x2="1983.5938" y1="128.5889" y2="1070.2393"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="95.3125" x="12.5" y="123.4299">Finanzas</text><ellipse cx="64.8438" cy="20.3125" fill="#FEFECE" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.125;"/><path d="M64.8438,32.8125 L64.8438,75 M44.5313,45.3125 L85.1563,45.3125 M64.8438,75 L44.5313,98.4375 M64.8438,75 L85.1563,98.4375 " fill="none" style="stroke: #A80036; stroke-width: 3.125;"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="95.3125" x="12.5" y="1088.9816">Finanzas</text><ellipse cx="64.8438" cy="1109.7656" fill="#FEFECE" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.125;"/><path d="M64.8438,1122.2656 L64.8438,1164.4531 M44.5313,1134.7656 L85.1563,1134.7656 M64.8438,1164.4531 L44.5313,1187.8906 M64.8438,1164.4531 L85.1563,1187.8906 " fill="none" style="stroke: #A80036; stroke-width: 3.125;"/><rect fill="#FEFECE" height="47.3389" style="stroke: #A80036; stroke-width: 2.34375;" width="143.75" x="303.9063" y="79.6875"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="121.875" x="314.8438" y="110.9299">Finanzas UI</text><rect fill="#FEFECE" height="47.3389" style="stroke: #A80036; stroke-width: 2.34375;" width="143.75" x="303.9063" y="1068.6768"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="121.875" x="314.8438" y="1099.9191">Finanzas UI</text><rect fill="#FEFECE" height="47.3389" style="stroke: #A80036; stroke-width: 2.34375;" width="153.125" x="1035.1563" y="79.6875"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="131.25" x="1046.0938" y="110.9299">API Gateway</text><rect fill="#FEFECE" height="47.3389" style="stroke: #A80036; stroke-width: 2.34375;" width="153.125" x="1035.1563" y="1068.6768"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="131.25" x="1046.0938" y="1099.9191">API Gateway</text><rect fill="#FEFECE" height="47.3389" style="stroke: #A80036; stroke-width: 2.34375;" width="200" x="1261.7188" y="79.6875"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="178.125" x="1272.6563" y="110.9299">Lambda Invoices</text><rect fill="#FEFECE" height="47.3389" style="stroke: #A80036; stroke-width: 2.34375;" width="200" x="1261.7188" y="1068.6768"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="178.125" x="1272.6563" y="1099.9191">Lambda Invoices</text><rect fill="#FEFECE" height="47.3389" style="stroke: #A80036; stroke-width: 2.34375;" width="200" x="1477.3438" y="79.6875"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="178.125" x="1488.2813" y="110.9299">Lambda Uploads</text><rect fill="#FEFECE" height="47.3389" style="stroke: #A80036; stroke-width: 2.34375;" width="200" x="1477.3438" y="1068.6768"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="178.125" x="1488.2813" y="1099.9191">Lambda Uploads</text><rect fill="#FEFECE" height="47.3389" style="stroke: #A80036; stroke-width: 2.34375;" width="143.75" x="1799.2188" y="79.6875"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="121.875" x="1810.1563" y="110.9299">DynamoDB</text><rect fill="#FEFECE" height="47.3389" style="stroke: #A80036; stroke-width: 2.34375;" width="143.75" x="1799.2188" y="1068.6768"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="121.875" x="1810.1563" y="1099.9191">DynamoDB</text><rect fill="#FEFECE" height="47.3389" style="stroke: #A80036; stroke-width: 2.34375;" width="50" x="1958.5938" y="79.6875"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="1969.5313" y="110.9299">S3</text><rect fill="#FEFECE" height="47.3389" style="stroke: #A80036; stroke-width: 2.34375;" width="50" x="1958.5938" y="1068.6768"/><text fill="#000000" font-family="sans-serif" font-size="21.875" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="1969.5313" y="1099.9191">S3</text><polygon fill="#A80036" points="357.0313,170.9839,372.6563,177.2339,357.0313,183.4839,363.2813,177.2339" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625;" x1="64.8438" x2="366.4063" y1="177.2339" y2="177.2339"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="273.4375" x="75.7813" y="169.3184">Captura factura y evidencia</text><polygon fill="#A80036" points="1092.9688,216.5039,1108.5938,222.7539,1092.9688,229.0039,1099.2188,222.7539" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625;" x1="375.7813" x2="1102.3438" y1="222.7539" y2="222.7539"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="348.4375" x="386.7188" y="214.8384">POST /projects/{projectId}/invoices</text><polygon fill="#A80036" points="1342.9688,262.0239,1358.5938,268.2739,1342.9688,274.5239,1349.2188,268.2739" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625;" x1="1111.7188" x2="1352.3438" y1="268.2739" y2="268.2739"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="212.5" x="1122.6563" y="260.3584">validar JWT + payload</text><polygon fill="#A80036" points="1852.3438,307.5439,1867.9688,313.7939,1852.3438,320.0439,1858.5938,313.7939" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625;" x1="1361.7188" x2="1861.7188" y1="313.7939" y2="313.7939"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="237.5" x="1372.6563" y="305.8784">Guardar INVOICE (draft)</text><polygon fill="#A80036" points="1378.9063,353.064,1363.2813,359.314,1378.9063,365.564,1372.6563,359.314" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 2.0,2.0;" x1="1369.5313" x2="1869.5313" y1="359.314" y2="359.314"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="1388.2813" y="351.3985">OK</text><polygon fill="#A80036" points="1128.9063,398.584,1113.2813,404.834,1128.9063,411.084,1122.6563,404.834" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 2.0,2.0;" x1="1119.5313" x2="1360.1563" y1="404.834" y2="404.834"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="153.125" x="1138.2813" y="396.9185">201 + invoiceId</text><polygon fill="#A80036" points="392.9688,444.104,377.3438,450.354,392.9688,456.604,386.7188,450.354" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 2.0,2.0;" x1="383.5938" x2="1110.1563" y1="450.354" y2="450.354"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="85.9375" x="402.3438" y="442.4385">invoiceId</text><polygon fill="#A80036" points="1092.9688,489.624,1108.5938,495.874,1092.9688,502.124,1099.2188,495.874" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625;" x1="375.7813" x2="1102.3438" y1="495.874" y2="495.874"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="317.1875" x="386.7188" y="487.9585">POST /uploads/docs (metadata)</text><polygon fill="#A80036" points="1558.5938,535.144,1574.2188,541.394,1558.5938,547.644,1564.8438,541.394" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625;" x1="1111.7188" x2="1567.9688" y1="541.394" y2="541.394"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="171.875" x="1122.6563" y="533.4785">validar referencia</text><polygon fill="#A80036" points="1852.3438,580.6641,1867.9688,586.9141,1852.3438,593.1641,1858.5938,586.9141" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625;" x1="1577.3438" x2="1861.7188" y1="586.9141" y2="586.9141"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="256.25" x="1588.2813" y="578.9986">Registrar DOC metadatos</text><polygon fill="#A80036" points="1964.8438,626.1841,1980.4688,632.4341,1964.8438,638.6841,1971.0938,632.4341" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625;" x1="1577.3438" x2="1974.2188" y1="632.4341" y2="632.4341"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="306.25" x="1588.2813" y="624.5186">Subir archivo (prefijo proyecto)</text><polygon fill="#A80036" points="1594.5313,671.7041,1578.9063,677.9541,1594.5313,684.2041,1588.2813,677.9541" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 2.0,2.0;" x1="1585.1563" x2="1982.0313" y1="677.9541" y2="677.9541"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="1603.9063" y="670.0386">OK</text><polygon fill="#A80036" points="1128.9063,717.2241,1113.2813,723.4741,1128.9063,729.7241,1122.6563,723.4741" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 2.0,2.0;" x1="1119.5313" x2="1575.7813" y1="723.4741" y2="723.4741"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="120.3125" x="1138.2813" y="715.5586">200 + docId</text><polygon fill="#A80036" points="392.9688,762.7441,377.3438,768.9941,392.9688,775.2441,386.7188,768.9941" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 2.0,2.0;" x1="383.5938" x2="1110.1563" y1="768.9941" y2="768.9941"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="53.125" x="402.3438" y="761.0786">docId</text><polygon fill="#A80036" points="1092.9688,808.2642,1108.5938,814.5142,1092.9688,820.7642,1099.2188,814.5142" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625;" x1="375.7813" x2="1102.3438" y1="814.5142" y2="814.5142"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="698.4375" x="386.7188" y="806.5987">PUT /projects/{projectId}/invoices/{invoiceId}/status (ready/approved)</text><polygon fill="#A80036" points="1342.9688,853.7842,1358.5938,860.0342,1342.9688,866.2842,1349.2188,860.0342" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625;" x1="1111.7188" x2="1352.3438" y1="860.0342" y2="860.0342"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="176.5625" x="1122.6563" y="852.1187">validar evidencias</text><polygon fill="#A80036" points="1852.3438,899.3042,1867.9688,905.5542,1852.3438,911.8042,1858.5938,905.5542" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625;" x1="1361.7188" x2="1861.7188" y1="905.5542" y2="905.5542"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="337.5" x="1372.6563" y="897.6387">Actualizar estado + reconciliaci贸n</text><polygon fill="#A80036" points="1378.9063,944.8242,1363.2813,951.0742,1378.9063,957.3242,1372.6563,951.0742" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 2.0,2.0;" x1="1369.5313" x2="1869.5313" y1="951.0742" y2="951.0742"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="28.125" x="1388.2813" y="943.1587">OK</text><polygon fill="#A80036" points="1128.9063,990.3442,1113.2813,996.5942,1128.9063,1002.8442,1122.6563,996.5942" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 2.0,2.0;" x1="1119.5313" x2="1360.1563" y1="996.5942" y2="996.5942"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="129.6875" x="1138.2813" y="988.6787">200 + status</text><polygon fill="#A80036" points="392.9688,1035.8643,377.3438,1042.1143,392.9688,1048.3643,386.7188,1042.1143" style="stroke: #A80036; stroke-width: 1.5625;"/><line style="stroke: #A80036; stroke-width: 1.5625; stroke-dasharray: 2.0,2.0;" x1="383.5938" x2="1110.1563" y1="1042.1143" y2="1042.1143"/><text fill="#000000" font-family="sans-serif" font-size="20.3125" lengthAdjust="spacingAndGlyphs" textLength="131.25" x="402.3438" y="1034.1988">Confirmaci贸n</text><!--MD5=[c16616c2db113f66032b570189131b85]
@startuml
skinparam backgroundColor #ffffff
skinparam shadowing false
skinparam dpi 150
actor Finanzas
participant "Finanzas UI" as UI
participant "API Gateway" as APIGW
participant "Lambda Invoices" as LInv
participant "Lambda Uploads" as LUp
participant "DynamoDB" as Dynamo
participant "S3" as S3

Finanzas -> UI : Captura factura y evidencia
UI -> APIGW : POST /projects/{projectId}/invoices
APIGW -> LInv : validar JWT + payload
LInv -> Dynamo : Guardar INVOICE (draft)
Dynamo - -> LInv : OK
LInv - -> APIGW : 201 + invoiceId
APIGW - -> UI : invoiceId

UI -> APIGW : POST /uploads/docs (metadata)
APIGW -> LUp : validar referencia
LUp -> Dynamo : Registrar DOC metadatos
LUp -> S3 : Subir archivo (prefijo proyecto)
S3 - -> LUp : OK
LUp - -> APIGW : 200 + docId
APIGW - -> UI : docId

UI -> APIGW : PUT /projects/{projectId}/invoices/{invoiceId}/status (ready/approved)
APIGW -> LInv : validar evidencias
LInv -> Dynamo : Actualizar estado + reconciliaci贸n
Dynamo - -> LInv : OK
LInv - -> APIGW : 200 + status
APIGW - -> UI : Confirmaci贸n
@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.2+13-58
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>