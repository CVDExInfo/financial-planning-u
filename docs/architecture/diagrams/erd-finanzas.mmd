---
title: Financial Planning System - Entity Relationship Diagram
description: Data model for PMO Estimator and SDMT Cost Management
---

classDiagram
  class User {
    +String user_id PK
    +String email
    +String display_name
    +String[] cognito_groups
    +String preferred_role
    +DateTime last_login
  }

  class Role {
    +String role_name PK
    +String description
    +String[] permissions
  }

  class Project {
    +String project_id PK
    +String name
    +String pm_user_id FK
    +String status (DRAFT|ACTIVE|ON_HOLD|CLOSED)
    +Date start_date
    +Date end_date
    +Decimal total_budget
    +String currency
    +DateTime created_at
    +DateTime updated_at
  }

  class BudgetBaseline {
    +String baseline_id PK
    +String project_id FK
    +Integer version
    +String signature_hash
    +String signed_by_user_id FK
    +DateTime signed_at
    +String status (DRAFT|SIGNED|SUPERSEDED)
    +Decimal total_labor_cost
    +Decimal total_non_labor_cost
    +JSON fx_assumptions
    +JSON indexation_assumptions
  }

  class CostCatalogItem {
    +String item_id PK
    +String category (LABOR|SOFTWARE|HARDWARE|SERVICES|TRAVEL|OTHER)
    +String name
    +String description
    +String ikusi_tier (GO|PREMIUM|GOLD|PLATINUM|STAR)
    +Decimal unit_price
    +String unit (HOUR|MONTH|LICENSE|EACH)
    +String vendor
    +JSON tier_details
    +Boolean active
    +Integer version
    +DateTime created_at
  }

  class ForecastAllocation {
    +String allocation_id PK
    +String project_id FK
    +String item_id FK
    +String period (YYYY-MM)
    +Decimal amount_planned
    +Decimal amount_forecast
    +Decimal amount_actual
    +Decimal variance
    +String notes
    +DateTime updated_at
  }

  class Invoice {
    +String invoice_id PK
    +String project_id FK
    +String vendor_name
    +String invoice_number
    +Decimal amount
    +String currency
    +Date invoice_date
    +String status (PENDING|MATCHED|DISPUTED|APPROVED)
    +String matched_allocation_id FK
    +String dispute_reason
    +String s3_document_key
    +DateTime created_at
  }

  class CashFlowProjection {
    +String projection_id PK
    +String project_id FK
    +String period (YYYY-MM)
    +Decimal inflow
    +Decimal outflow
    +Decimal net_cashflow
    +Decimal cumulative_cashflow
    +Decimal margin_percent
    +DateTime calculated_at
  }

  class AuditLog {
    +String log_id PK
    +String entity_type
    +String entity_id
    +String action (CREATE|UPDATE|DELETE|APPROVE|REJECT)
    +String user_id FK
    +JSON before_state
    +JSON after_state
    +String ip_address
    +DateTime timestamp
  }

  class Notification {
    +String notification_id PK
    +String user_id FK
    +String type (BUDGET_ALERT|APPROVAL_REQUIRED|VARIANCE_WARNING)
    +String message
    +String related_entity_id
    +Boolean read
    +DateTime created_at
  }

  class ExportJob {
    +String job_id PK
    +String user_id FK
    +String export_type (PDF|EXCEL|CSV)
    +String entity_type
    +String[] entity_ids
    +String status (PENDING|PROCESSING|COMPLETED|FAILED)
    +String s3_output_key
    +DateTime created_at
    +DateTime completed_at
  }

  %% Relationships
  User "1" -- "many" Project : manages_as_pm
  User "1" -- "many" BudgetBaseline : signs
  User "1" -- "many" AuditLog : performs
  User "1" -- "many" Notification : receives
  User "1" -- "many" ExportJob : requests
  User "many" -- "many" Role : has_roles
  
  Project "1" -- "many" BudgetBaseline : versions
  Project "1" -- "many" ForecastAllocation : allocations
  Project "1" -- "many" Invoice : invoices
  Project "1" -- "many" CashFlowProjection : projections
  
  CostCatalogItem "1" -- "many" ForecastAllocation : used_in
  
  ForecastAllocation "1" -- "0..1" Invoice : matched_to
  
  BudgetBaseline "1" -- "many" AuditLog : tracked_by
  ForecastAllocation "1" -- "many" AuditLog : tracked_by
  Invoice "1" -- "many" AuditLog : tracked_by
