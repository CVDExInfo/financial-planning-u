---
title: Finanzas SD - Network & Security Architecture
description: CloudFront, API Gateway, and Lambda security architecture
---

%%{init: {'theme':'base', 'themeVariables': { 
  'primaryColor':'#D13212',
  'primaryTextColor':'#fff',
  'primaryBorderColor':'#232F3E',
  'lineColor':'#545B64',
  'secondaryColor':'#FF9900',
  'tertiaryColor':'#146EB4'
}}}%%

flowchart TB
    %% Internet Layer
    subgraph INTERNET["üåê Internet"]
        direction LR
        USERS["End Users<br/>PMO / SDMT / VENDOR / EXEC"]
    end
    
    %% Edge Security Layer
    subgraph EDGE["üõ°Ô∏è Edge Security & CDN"]
        direction TB
        ROUTE53["Route 53<br/>DNS Resolution<br/>Health Checks"]
        WAF["AWS WAF<br/>DDoS Protection<br/>Rate Limiting<br/>SQL Injection Filter<br/>XSS Protection"]
        SHIELD["AWS Shield Standard<br/>Layer 3/4 Protection<br/>Auto Mitigation"]
        CF["CloudFront Distribution<br/>d7t9x3j66yd8k.cloudfront.net<br/>SSL/TLS Termination<br/>Path: /finanzas/*"]
    end
    
    %% Frontend Layer
    subgraph FRONTEND["üì¶ Frontend Storage"]
        direction TB
        S3_UI["S3 Bucket (Private)<br/>No Public Access<br/>Bucket Policy: OAC Only<br/>Encryption: AES-256"]
        OAC["Origin Access Control<br/>CloudFront ‚Üí S3<br/>Signed Requests"]
    end
    
    %% Authentication Layer
    subgraph AUTH["üîê Authentication & Authorization"]
        direction TB
        COGNITO["Cognito User Pool<br/>us-east-2_FyHLtOhiY<br/>MFA Optional<br/>Password Policy Enforced"]
        AVP["Verified Permissions<br/>Policy Store<br/>Cedar Language<br/>RBAC Engine"]
        JWT["JWT Validation<br/>Token Signature Check<br/>Expiry Verification"]
    end
    
    %% API Layer
    subgraph API_LAYER["üö™ API Gateway (us-east-2)"]
        direction TB
        APIGW["API Gateway REST<br/>m3g6am67aj.execute-api.us-east-2.amazonaws.com<br/>Custom Domain: TBD<br/>SSL Certificate: ACM"]
        THROTTLE["Throttling & Quotas<br/>Rate: 10000 req/sec<br/>Burst: 5000<br/>Per-user Limits"]
        AUTHORIZER["Custom Authorizer Lambda<br/>JWT Validation<br/>AVP Permission Check<br/>Cache: 5 min"]
    end
    
    %% Compute Layer
    subgraph COMPUTE["‚öôÔ∏è Compute Layer"]
        direction LR
        LAMBDA_PMO["PMO Lambda<br/>Execution Role<br/>DynamoDB Access<br/>S3 Access"]
        LAMBDA_SDMT["SDMT Lambda<br/>Execution Role<br/>DynamoDB Access"]
        LAMBDA_FORECAST["Forecast Lambda<br/>Execution Role<br/>DynamoDB Access"]
        LAMBDA_RECON["Reconciliation Lambda<br/>Execution Role<br/>DynamoDB + S3"]
        LAMBDA_ANALYTICS["Analytics Lambda<br/>Execution Role<br/>DynamoDB Read-Only"]
    end
    
    %% Data Layer
    subgraph DATA["üíæ Data Layer"]
        direction TB
        DDB["DynamoDB Tables<br/>Encryption at Rest: KMS<br/>Point-in-time Recovery<br/>Backup Enabled"]
        S3_DOCS["S3 Documents Bucket<br/>Encryption: SSE-S3<br/>Versioning Enabled<br/>Lifecycle Policies"]
        KMS["AWS KMS<br/>Customer Managed Keys<br/>Automatic Rotation<br/>CloudTrail Audit"]
    end
    
    %% Security Services
    subgraph SECURITY["üîí Security & Compliance"]
        direction TB
        SECRETS["Secrets Manager<br/>API Keys<br/>Database Credentials<br/>Auto Rotation"]
        CLOUDTRAIL["CloudTrail<br/>API Activity Logs<br/>S3 Bucket<br/>90-day Retention"]
        GUARD["GuardDuty (Optional)<br/>Threat Detection<br/>Anomaly Monitoring"]
    end
    
    %% Monitoring Layer
    subgraph MONITORING["üìä Monitoring & Logging"]
        direction TB
        CW_LOGS["CloudWatch Logs<br/>Log Groups per Lambda<br/>Retention: 14 days"]
        CW_METRICS["CloudWatch Metrics<br/>Custom Dashboards<br/>Alarms: Error Rate"]
        XRAY["X-Ray Tracing<br/>End-to-End Latency<br/>Service Map"]
    end
    
    %% Security Flow
    USERS -->|HTTPS| ROUTE53
    ROUTE53 --> WAF
    WAF --> SHIELD
    SHIELD --> CF
    CF -->|/finanzas/*| S3_UI
    S3_UI -.OAC.-> OAC
    
    %% Authentication Flow
    USERS -.Login.-> COGNITO
    COGNITO -.JWT Token.-> USERS
    
    %% API Flow
    S3_UI -->|API Call + JWT| APIGW
    APIGW --> THROTTLE
    THROTTLE --> AUTHORIZER
    AUTHORIZER -->|Validate| COGNITO
    AUTHORIZER -->|Check Permissions| AVP
    AUTHORIZER -->|Verify Signature| JWT
    
    %% Lambda Execution
    APIGW -->|Invoke| LAMBDA_PMO
    APIGW -->|Invoke| LAMBDA_SDMT
    APIGW -->|Invoke| LAMBDA_FORECAST
    APIGW -->|Invoke| LAMBDA_RECON
    APIGW -->|Invoke| LAMBDA_ANALYTICS
    
    %% Data Access
    LAMBDA_PMO & LAMBDA_SDMT & LAMBDA_FORECAST & LAMBDA_RECON & LAMBDA_ANALYTICS -->|IAM Role| DDB
    LAMBDA_PMO & LAMBDA_RECON -->|IAM Role| S3_DOCS
    DDB & S3_DOCS -.Encrypted.-> KMS
    
    %% Security & Monitoring
    LAMBDA_PMO & LAMBDA_SDMT & LAMBDA_FORECAST & LAMBDA_RECON & LAMBDA_ANALYTICS -.Secrets.-> SECRETS
    APIGW & COGNITO & AVP -.Audit.-> CLOUDTRAIL
    LAMBDA_PMO & LAMBDA_SDMT & LAMBDA_FORECAST & LAMBDA_RECON & LAMBDA_ANALYTICS -.Logs.-> CW_LOGS
    LAMBDA_PMO & LAMBDA_SDMT & LAMBDA_FORECAST & LAMBDA_RECON & LAMBDA_ANALYTICS -.Metrics.-> CW_METRICS
    LAMBDA_PMO & LAMBDA_SDMT & LAMBDA_FORECAST & LAMBDA_RECON & LAMBDA_ANALYTICS -.Traces.-> XRAY
    
    %% Styling
    classDef securityRed fill:#D13212,stroke:#232F3E,stroke-width:3px,color:#fff,font-weight:bold
    classDef networkOrange fill:#FF9900,stroke:#232F3E,stroke-width:3px,color:#000,font-weight:bold
    classDef computePurple fill:#8B5CF6,stroke:#232F3E,stroke-width:3px,color:#fff,font-weight:bold
    classDef dataGreen fill:#3F8624,stroke:#232F3E,stroke-width:3px,color:#fff,font-weight:bold
    classDef authBlue fill:#146EB4,stroke:#232F3E,stroke-width:3px,color:#fff,font-weight:bold
    
    class WAF,SHIELD,SECRETS,CLOUDTRAIL,GUARD,KMS securityRed
    class ROUTE53,CF,S3_UI,OAC networkOrange
    class LAMBDA_PMO,LAMBDA_SDMT,LAMBDA_FORECAST,LAMBDA_RECON,LAMBDA_ANALYTICS computePurple
    class DDB,S3_DOCS dataGreen
    class COGNITO,AVP,JWT,APIGW,THROTTLE,AUTHORIZER authBlue
